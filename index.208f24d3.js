var e,t={};t=class{constructor(e){this.board=e||[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]],this.score=0,this.status="idle",this.previousState=JSON.parse(JSON.stringify(this.board))}moveLeft(){let e=!1;for(let t=0;t<4;t++){let r=this.board[t].filter(e=>0!==e);for(let t=0;t<r.length-1;t++)r[t]===r[t+1]&&(r[t]*=2,this.score+=r[t],r[t+1]=0,e=!0);for(r=r.filter(e=>0!==e);r.length<4;)r.push(0);e||this.board[t].every((e,t)=>e===r[t])||(e=!0),this.board[t]=r}return e&&this.generateTile(),e}moveRight(){this.board=this.board.map(e=>e.reverse());let e=this.moveLeft();return this.board=this.board.map(e=>e.reverse()),e}moveUp(){let e=!1;for(let t=0;t<4;t++){let r=[];for(let e=0;e<4;e++)0!==this.board[e][t]&&r.push(this.board[e][t]);for(let t=0;t<r.length-1;t++)r[t]===r[t+1]&&(r[t]*=2,this.score+=r[t],r[t+1]=0,e=!0);for(r=r.filter(e=>0!==e);r.length<4;)r.push(0);for(let s=0;s<4;s++)this.board[s][t]!==r[s]&&(e=!0),this.board[s][t]=r[s]}return e&&this.generateTile(),e}moveDown(){this.#e();let e=this.moveUp();return this.#e(),e}#e(){for(let e=0;e<4;e++)for(let t=0;t<2;t++){let r=this.board[t][e];this.board[t][e]=this.board[3-t][e],this.board[3-t][e]=r}}getScore(){return this.score}getState(){return this.board}getStatus(){return this.status}isWinner(){this.board.some(e=>e.includes(2048))&&(this.status="win")}isGameOver(){if(this.board.some(e=>e.includes(0)))return!1;for(let e=0;e<4;e++)for(let t=0;t<4;t++){let r=this.board[e][t];if(t<3&&r===this.board[e][t+1]||e<3&&r===this.board[e+1][t]||e<3&&r===this.board[e+1][t]||e>0&&r===this.board[e-1][t])return!1}return!0}start(){this.board=[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]],this.score=0,this.status="playing",this.generateTile(),this.generateTile()}restart(){this.board=[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]],this.score=0,this.status="idle"}generateTile(){let e=[];for(let t=0;t<4;t++)for(let r=0;r<4;r++)0===this.board[t][r]&&e.push({row:t,col:r});if(0===e.length)return;let{row:t,col:r}=e[Math.floor(Math.random()*e.length)];this.board[t][r]=.9>Math.random()?2:4}},function(e){let t=document.createElement("link");t.rel="icon",t.href=e,t.setAttribute("type","image/png");let r=document.querySelector("link[rel='icon']");r&&document.head.removeChild(r),document.head.appendChild(t)}("/images/favicon.png");const r=new((e=t)&&e.__esModule?e.default:e),s=document.querySelector(".button"),o=document.querySelector(".message-lose"),a=document.querySelector(".message-win"),i=document.querySelector(".message-start");function l(e){let t=e.getState(),r=document.querySelectorAll(".field-cell");for(let e=0;e<4;e++)for(let s=0;s<4;s++){let o=r[4*e+s];0===t[e][s]?(o.textContent="",o.className="field-cell"):(o.textContent=t[e][s],o.className=`field-cell field-cell--${t[e][s]}`)}let s=document.querySelector(".game-score"),o=e.getScore();s.innerHTML="",s.textContent=o}function n(e){o.classList.add("hidden"),a.classList.add("hidden"),i.classList.add("hidden"),"win"===e?a.classList.remove("hidden"):"lose"===e?o.classList.remove("hidden"):"start"===e&&i.classList.remove("hidden")}s.addEventListener("click",()=>{s.classList.contains("start")?(r.start(),l(r),n(),s.classList.remove("start"),s.classList.add("restart"),s.textContent="Restart"):(r.restart(),l(r),s.classList.remove("restart"),s.classList.add("start"),s.textContent="Start",n("start"))}),document.addEventListener("keydown",e=>{if(e.defaultPrevented||"playing"!==r.getStatus())return;let t=!1;switch(e.key){case"ArrowLeft":t=r.moveLeft();break;case"ArrowRight":t=r.moveRight();break;case"ArrowUp":t=r.moveUp();break;case"ArrowDown":t=r.moveDown();break;default:return}if(t){if(l(r),s.classList.contains("start")&&(s.classList.remove("start"),s.classList.add("restart"),s.textContent="Restart"),r.isWinner()){n("win"),s.classList.remove("restart"),s.classList.add("start"),s.textContent="Start";return}if(r.isGameOver()){n("lose");return}}e.preventDefault()});
//# sourceMappingURL=index.208f24d3.js.map
